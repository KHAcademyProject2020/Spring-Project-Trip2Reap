<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis/org//DTD Mapper 3.0/EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="reviewMapper">
	
  	<select id="getListCount" resultType="_int">
		select count(*)
    	from board
  		where BO_DELETE_YN='N' 
  	</select>
  	
  	<select id="selectList" resultMap="reviewResultSet">
  		 select *
  		 from board
         JOIN CATEGORY USING(CA_CODE)
   		 where BO_DELETE_YN='N' AND CA_CODE=3 OR CA_CODE=4
   		 order by BO_NO desc 
   		<!-- select *
  		 from board B
         INNER JOIN CATEGORY C
             ON B.CA_CODE = C.CA_CODE
         INNER JOIN IMG_FILE I
             ON B.BO_NO = I.BO_NO
   		 where B.BO_DELETE_YN='N' AND B.CA_CODE=3 OR B.CA_CODE=4
   		 order by B.BO_NO desc -->

   		 
  	</select>

  <resultMap type="Review" id="reviewResultSet">
      <id column="BO_NO" property="boNo"/>
      <result column="CA_CODE" property="caCode"/>
      <result column="BO_TITLE" property="boTitle"/>
      <result column="BO_CONTENT" property="boContent"/>
      <result column="MEMBER_ID" property="memberId"/>
      <result column="BO_COUNT" property="boCount"/>
      <result column="BO_TAG" property="boTag"/>
      <result column="BO_DELETE_YN" property="boDeleteYN"/>
      <result column="REGDATE" property="regDate"/>
      <result column="CA_NAME" property="caName"/> 
      <result column="ORIGIN_NAME" property="originName"/>
      <result column="CHANGE_NAME" property="changeName"/>
   </resultMap>
   
  	 <update id="addReadCount">
   		update board
   		set BO_COUNT= BO_COUNT + 1
   		where BO_NO= #{boNo}
   </update>
 

   <select id="selectReview" resultMap="reviewResultSet">
   	   select *
       from board
       JOIN CATEGORY USING(CA_CODE)
       where BO_NO=#{boNo} and BO_DELETE_YN='N' 
   </select> 
   
  <insert id="insertReview">
		<!-- INSERT
 		INTO BOARD (BO_NO,MEMBER_ID,CA_CODE,BO_TITLE,BO_TAG,BO_CONTENT)
 		VALUES(SEQ_BO_NO.NEXTVAL,#{memberId},#{caCode},#{boTitle},#{boTag},#{boContent})	-->
	
 		INSERT ALL 
		INTO BOARD(BO_NO,MEMBER_ID,CA_CODE,BO_TITLE,BO_TAG,BO_CONTENT)
		VALUES(SEQ_BO_NO.NEXTVAL,#{memberId},#{caCode},#{boTitle},#{boTag},#{boContent})
		INTO IMG_FILE 
		VALUES(SEQ_FILE_NO.NEXTVAL,SEQ_BO_NO.NEXTVAL,#{originName},#{changeName},1,'null',DEFAULT)
		SELECT *
		FROM DUAL
  </insert>
  
  <insert id="insertBoard">
  		INSERT
 		INTO BOARD (BO_NO,MEMBER_ID,CA_CODE,BO_TITLE,BO_TAG,BO_CONTENT)
 		VALUES(SEQ_BO_NO.NEXTVAL,#{memberId},#{caCode},#{boTitle},#{boTag},#{boContent})
  </insert>


</mapper>










